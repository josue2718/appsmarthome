<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles/home.css">
    <link rel="stylesheet" href="styles/switch.css">
    <link rel="stylesheet" href="styles/bar.css">
    <link rel="stylesheet" href="styles/camara.css">
    <script src="views/navigation.js"></script>
    <script defer src="services/OnOffFoco.js"></script> <!-- Se carga el nuevo script -->
</head>
<body>
    <div class="app-container">

        <div class="nav">

        </div>

        <div class="select-devices" id="abrirMisDispositivos">
            <h2>Selecciona un dispositivo</h2>
            <div class="device-content">
               
            </div>

            
        </div>
        <button id="openModal">Abrir Modal</button>
        
        <div class="modo-hora-container" id="modal-confirmacion">
            <p>¿Quieres cambiar a "Modo por Hora"?</p>
            <div class="mh-content">
                <div class="hora-container">
                    <p>Encender</p>
                    <input type="time" id="encender-time">
                    <p>Apagar</p>
                    <input type="time" id="apagar-time">
                </div>
                <div class="hora-btn">
                    <button id="confirmar-cambio">Confirmar</button>
                    <button id="cancelar-cambio">Cancelar</button>
                </div>
            </div>
        </div>
        
        
        <div class="switch-container">
            <div class="border">
                <label class="switch" >
                    <input type="checkbox" id="automatico">
                    <span class="slider"></span>
                </label>
            </div>

            <p id="modo">Modo por hora</p>
            
            <div id="hora-config">
                <div class="time">
                    <div class="start">
                        <label>Inicio  <p id="prender-time"></p>  </label>
                    </div>
                    <div class="end">
                        <label>Final <p id="apagar-time1"></p>  </label>
                    </div>
                </div>   
            </div>
        </div>

        <div class="btn-power">
            <button class="on-off" id="toggleButton">
                <img id="toggleImage" src="assets/OFF.svg" alt="Icono SVG">
                <p id="toggleText">Apagado</p>
            </button>
        </div>

        <div class="device">
            <button onclick="abrirMisDisp()">Seleccionar</button>
        </div>

        <nav class="bottom-var">
            <button onclick="monitoreoView()">
                <img src="assets/activity.svg" alt="Monitoreo">
                <p>Monitoreo</p>
            </button>

            <button onclick="inicioView()"> 
                <img src="assets/layout-grid.svg" alt="Inicio">
                <p>Inicio</p>
            </button>

            <button onclick="dispositivosView()">
                <img src="assets/monitor-speaker.svg" alt="Dispositivos">
                <p>Dispositivos</p>
            </button>
        </nav>
       

        <div id="myModal" class="modal" style="display: none;" >
            <div class="modal-content">
                <h2>Camara</h2>
                <br>
                <button class="close-btn">&times;</button>
                <div id="camera-stream">
                    <img id="live-feed" src="http://192.168.22.34:81/stream" alt="Cámara en vivo">
                </div>
            </div>

           
        </div>
        
     
        

    </div>
    <script>


    const modal = document.getElementById("myModal");
    const openBtn = document.getElementById("openModal");
    const closeBtn = document.querySelector(".close-btn");

    // Función para abrir el modal
    function openModal() {
        modal.style.display = "flex";
    }

    // Función para cerrar el modal
    function closeModal() {
        modal.style.display = "none";
    }

    // Evento para abrir el modal
    openBtn.addEventListener("click", openModal);

    // Evento para cerrar el modal con el botón
    closeBtn.addEventListener("click", closeModal);

    // Evento para cerrar el modal haciendo clic fuera del contenido
    window.addEventListener("click", function (e) {
        if (e.target === modal) {
            closeModal();
        }
    });

    // Evento para cerrar el modal con la tecla "Esc"
    document.addEventListener("keydown", function (e) {
        if (e.key === "Escape") {
            closeModal();
        }
    });

        // Función para abrir el contenedor
        function abrirMisDisp() {
          document.getElementById("abrirMisDispositivos").style.display = "block";
        }
    
        // Detectar clics fuera del contenedor para cerrarlo
        window.addEventListener('click', function(e) {
          const contenedor = document.getElementById("abrirMisDispositivos");
          const botonAbrir = document.querySelector(".device button");
    
          // Si el contenedor está visible y el clic no es dentro del contenedor ni en el botón
          if (contenedor.style.display === "block" &&
              !contenedor.contains(e.target) &&
              e.target !== botonAbrir) {
            contenedor.style.display = "none";
          }
        });
      </script>
    <script>
        // Función para abrir el contenedor
        function abrirMisDisp() {
          document.getElementById("abrirMisDispositivos").style.display = "block";
        }
    
        // Detectar clics fuera del contenedor para cerrarlo
        window.addEventListener('click', function(e) {
          const contenedor = document.getElementById("abrirMisDispositivos");
          const botonAbrir = document.querySelector(".device button");
    
          // Si el contenedor está visible y el clic no es dentro del contenedor ni en el botón
          if (contenedor.style.display === "block" &&
              !contenedor.contains(e.target) &&
              e.target !== botonAbrir) {
            contenedor.style.display = "none";
          }
        });
      </script>
          <script src="services/SelectDevice.js"></script>
          <script src="services/notificaciones.js"></script>
          <script src="services/mode.js"></script>
</body>
</html>